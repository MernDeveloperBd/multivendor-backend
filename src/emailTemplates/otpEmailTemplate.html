<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{appName}} OTP</title>
</head>
<body style="margin:0;padding:0;background:#f6f7f9;">
  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background:#f6f7f9;">
    <tr>
      <td align="center" style="padding:24px;">
        <table role="presentation" width="560" cellpadding="0" cellspacing="0" style="max-width:560px;background:#ffffff;border-radius:10px;overflow:hidden;">
          <tr>
            <td style="padding:24px;font-family:Arial,Helvetica,sans-serif;font-size:20px;color:#111;">
              <strong>{{appName}}</strong>
            </td>
          </tr>
          <tr>
            <td style="padding:0 24px 8px;font-family:Arial,Helvetica,sans-serif;font-size:16px;color:#333;">
              Use the following OTP to complete your login:
            </td>
          </tr>
          <tr>
            <td align="center" style="padding:8px 24px 24px;">
              <div style="display:inline-block;letter-spacing:4px;font-family:monospace;font-size:32px;font-weight:700;color:#111;background:#f0f3f7;padding:12px 18px;border-radius:8px;">
                {{otp}}
              </div>
              <div style="font-family:Arial,Helvetica,sans-serif;font-size:12px;color:#666;margin-top:8px;">
                Expires in {{ttl}} minute(s)
              </div>
            </td>
          </tr>
          <tr>
            <td style="padding:0 24px 24px;font-family:Arial,Helvetica,sans-serif;font-size:14px;color:#666;">
              If you did not request this, please ignore this email.
            </td>
          </tr>
          <tr>
            <td style="padding:16px 24px;font-family:Arial,Helvetica,sans-serif;font-size:12px;color:#999;border-top:1px solid #eee;">
              © {{year}} {{appName}}
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>


<!--  এটাকে sendEmail.js এ বসিয়ে দিলেই হবে।
const fs = require('fs').promises;
const path = require('path');
const nodemailer = require('nodemailer');

const transporter = nodemailer.createTransport({
  service: 'gmail',
  auth: {
    user: process.env.EMAIL_USER || "kenakatabazarbd@gmail.com", 
    pass: process.env.EMAIL_PASS || "yxynfawxnnaiqhqi"          
  }
});

async function loadOtpTemplate(otp) {
  try {
    const templatePath = path.join(__dirname, 'templates', 'otpEmailTemplate.html');
    let html = await fs.readFile(templatePath, 'utf-8');
    return html.replace(/{{otp}}/g, otp);
  } catch (err) {
    console.warn("⚠️ Template not found, falling back to plain text OTP");
    return `Your OTP is <b>${otp}</b>. Please enter it to complete your login.`;
  }
}

async function sendVerificationEmail(to, subject, body) {

  let finalHtml;
  if (body.includes("{{otp}}")) {
    const otp = body.match(/{{otp}}/g) ? body.replace(/[^0-9]/g, '').slice(0, 6) : "123456"; 
    finalHtml = await loadOtpTemplate(otp);
  } else {
    finalHtml = body;
  }

  const finalSubject = subject || "MM Fashion World Login/sign up OTP";

  const mailOptions = {
    from: '"MM Fashion World" <kenakatabazarbd@gmail.com>',
    to,
    subject: finalSubject,
    html: finalHtml
  };

  try {
    await transporter.sendMail(mailOptions);
    console.log(`✅ Email sent to ${to}`);
  } catch (error) {
    console.error(`❌ Failed to send email to ${to}:`, error.message);
    throw new Error("Failed to send email. Please try again.");
  }
}

async function sendOtpEmail(email, otp) {
  const subject = "MM Fashion World Login/sign up OTP";
  const body = `Your otp is {{otp}}. Please enter it to complete your login`;
  return sendVerificationEmail(email, subject, body);
}

module.exports = sendVerificationEmail;

 -->